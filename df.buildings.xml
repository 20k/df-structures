<data-definition>
  <class-type type-name='building' original-name='buildingst' key-field='id'>
    <int32_t name='x1' comment='left'/>
    <int32_t name='y1'/>
    <int32_t name='x2' comment='work location'/>
    <int32_t name='x3' comment='right'/>
    <int32_t name='y3'/>
    <int32_t name='y2'/>
    <int32_t name='z'/>
    <int32_t name='height'/>

    <int16_t name='materialType' refers-to='(material-by-id $ $$._parent.materialIndex)'/>
    <int32_t name='materialIndex'/>

    <compound name='room'>
      <pointer name='extents' type-name='uint8_t'>
        <comment>0 - not room; 1 in stockpile; 2 wall; 3 inner; 4 distance boundary.</comment>
      </pointer>
      <int32_t name='x'/>
      <int32_t name='y'/>
      <int32_t name='width'/>
      <int32_t name='height'/>
    </compound>

    <int32_t name='age'/>
    <int16_t name='race' refers-to='$global.world.raws.creatures[$]'/>
    <int32_t name='id'/>

    <stl-vector name='jobs'>
      <pointer type-name='job'/>
    </stl-vector>
    <stl-vector name='meetings'>
      <pointer type-name='meeting_ref'/>
    </stl-vector>
    <stl-vector name='unk6' type-name='pointer'/>
    <bool name='is_room'/>

    <stl-vector name='children' comment='other buildings within this room'>
      <pointer type-name='building'/>
    </stl-vector>
    <stl-vector name='parents' comment='rooms this building belongs to'>
      <pointer type-name='building'/>
    </stl-vector>

    <pointer type-name='unit' name='owner'/>

    <stl-vector name='unk7' type-name='pointer'/>
    <stl-string name='name'/>

    <stl-vector name='activities'>
      <pointer>
        <int32_t name='id' refers-to='(find-activity $)'/>
        <int32_t name='is_group'/>
      </pointer>
    </stl-vector>
  </class-type>

  -- stockpile --

  <class-type type-name='building_stockpilest' inherits-from='building'>
    <compound type-name='stockpile_settings' name='settings'/>

    <int16_t name='max_barrels'/>
    <int16_t name='max_bins'/>

    <stl-vector name='container_type' type-name='int16_t' comment='17 barrel, 31 bin'/>
    <stl-vector name='container_item_id'>
      <int32_t refers-to='(find-item $)'/>
    </stl-vector>
    <stl-vector name='container_x' type-name='int16_t'/>
    <stl-vector name='container_y' type-name='int16_t'/>

    <pointer name='give_to' type-name='building_stockpile'/>
    <stl-vector name='take_from'>
      <pointer type-name='building_stockpile'/>
    </stl-vector>

    <int32_t name='stockpile_number'/>
  </class-type>

  -- actual --

  <class-type type-name='building_actual' inherits-from='building'
              original-name='building_actualst'>
    <int16_t name='unk_ac'/>

    <stl-vector name='contained_items'>
      <pointer>
        <pointer name='item' type-name='item'/>
        <int16_t name='use_mode'/>
      </pointer>
    </stl-vector>

    <pointer name='unk_bc' comment='m.b. raw reference? oth, seems to be unique ref'>
      <int32_t name='unk1'/>
      <int32_t name='unk2'/>
      <int16_t name='unk3'/>
      <int32_t name='unk4'/>
      <int32_t name='unk5'/>
      <int16_t name='unk6'/>
      <int16_t name='unk6b'/>
      <int32_t name='unk7'/>
      <int32_t name='unk8'/>
      <int16_t name='unk9'/>
      <int32_t name='unk10'/>
      <int32_t name='unk11'/>
      <int32_t name='unk12'/>
      <int32_t name='unk13'/>
    </pointer>
  </class-type>

  -- specific --

  <class-type type-name='building_archery_target' inherits-from='building_actual'
              original-name='building_archerytargetst'>

  </class-type>

  <class-type type-name='building_bedst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_boxst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_bridgest' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_cabinetst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_cagest' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_chainst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_chairst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_coffinst' inherits-from='building_actual'>
    <compound name='burial_mode'>
      <flag-bit name='allow_burial'/>
      <flag-bit name='no_citizens'/>
      <flag-bit name='no_pets'/>
      <static-array type-name='flag-bit' name='unused' count='13'/>
    </compound>
  </class-type>

  <class-type type-name='building_constructionst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_doorst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_farmplotst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_floodgatest' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_furnacest' inherits-from='building_actual'>
    <stl-vector name='unk_c0' type-name='pointer'/>
  </class-type>

  <class-type type-name='building_gear_assemblyst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_grate_floorst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_grate_wallst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_hatchst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_nest_boxst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_road_pavedst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_screw_pumpst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_slabst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_statuest' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_tablest' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_tradedepotst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_trapst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_water_wheelst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_weaponrackst' inherits-from='building_actual'>
    <int16_t name='unk_c0'/>

    <stl-vector name='assignments'>
      <pointer>
        <int32_t name='squad_id'/>
        <compound name='mode'>
          <flag-bit name='sleep'/>
          <flag-bit name='train'/>
          <flag-bit name='indiv_eq'/>
          <flag-bit name='squad_eq'/>
          <static-array type-name='flag-bit' name='unused' count='28'/>
        </compound>
      </pointer>
    </stl-vector>

    <int32_t name='unk_d0'/>
  </class-type>

  <class-type type-name='building_wellst' inherits-from='building_actual'>

  </class-type>

  <class-type type-name='building_workshopst' inherits-from='building_actual'>

  </class-type>


  -- zone --

  <class-type type-name='building_civzonest' inherits-from='building'>

  </class-type>
</data-definition>

