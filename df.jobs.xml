<data-definition>
  <struct-type type-name='meeting_diplomat'>
    <int32_t name='unk1' comment='uninitialized'/>
    <pointer name='person1' type-name='unit' comment='diplomat'/>
    <pointer name='person2' type-name='unit' comment='count'/>
    <pointer name='place' type-name='building'/>
    <int16_t name='unk2' comment='1'/>
    <int8_t name='unk3' comment='3'/>
    <int16_t name='unk4' comment='0'/>
    <int32_t name='unk5' comment='-1'/>
  </struct-type>

  <struct-type type-name='meeting_pet' key-field='name'>
    <int32_t name='unk0' comment='uninitialized'/>
    <int32_t name='unk1' comment='-1'/>
    <int32_t name='pet_id' refers-to='(find-unit $)'/>
    <compound name='name' type-name='language_name'/>
    <int32_t name='unk3'/>
  </struct-type>

  <struct-type type-name='meeting_ref'>
    <int32_t name='unk1'
             comment='4 person, 7 pet (pet), 8 pet (owner)'/>
    <pointer name='ptr' comment='type varies'/>
    <int32_t name='unk2' comment='0'/>
  </struct-type>

  <struct-type type-name='job_list_link' key-field='job'>
    <pointer name='job' type-name='job'/>
    <pointer name='prev' type-name='job_list_link'/>
    <pointer name='next' type-name='job_list_link'/>
  </struct-type>

  <struct-type type-name='job' key-field='id'>
    <int32_t name='id'/>
    <pointer name='list_link' type-name='job_list_link'/>
    <int16_t name='job_id'/>
    <int32_t name='unk2'/>

    <int16_t name='x'/>
    <int16_t name='y'/>
    <int16_t name='z'/>

    <int32_t name='unk3'/>
    <pointer name='unk4' comment='garbage'/>

    <compound size='4' name='flags'>
      <flag-bit name='repeat'/>
      <flag-bit name='suspend'/>
    </compound>

    <int16_t name='matType' refers-to='(material-by-id $ $$._parent.matIndex)'/>
    <int32_t name='matIndex'/>
    <int16_t name='unk5'/>
    <int16_t name='unk6'/>
    <int16_t name='item_subtype'/>
    <int32_t name='unk7'/>
    <int32_t name='unk8'/>

    <static-array name='job_material_category' type-name='flag-bit' count='32'/>
    // bitmask - plant, wood, cloth, silk, leather, bone, shell, wood (duplicate?), soap, ivory/tooth, horn, pearl, yarn

    <stl-string name='reaction_name'/>

    <int32_t name='unk9'/>
    <int32_t name='unk10'/>

    <stl-vector name='items'>
      <pointer>
        <pointer name='item' type-name='item'/>
        <int32_t name='unk1'/>
        <int32_t name='unk2'/>
        <int32_t name='unk3'/>
      </pointer>
    </stl-vector>

    <stl-vector name='unk11' type-name='pointer'/>

    <stl-vector name='references'>
      <pointer type-name='general_ref'/>
    </stl-vector>

    <stl-vector name='job_items'>
      <pointer type-name='job_item'/>
    </stl-vector>
  </struct-type>

  <struct-type type-name='job_item'>
    <int16_t name='itemType'/>
    <int16_t name='itemSubtype'/>
    <int16_t name='matType' refers-to='(material-by-id $ $$._parent.matIndex)'/>
    <int32_t name='matIndex'/>

    <static-array name='flags1' type-name='flag-bit' count='32'/>

    <int32_t name='count'/>
    <int16_t name='unk1'/>

    <static-array name='flags2' type-name='flag-bit' count='32'/>
    <int32_t name='unk2'/>
    <static-array name='flags3' type-name='flag-bit' count='32'/>
    <int32_t name='unk3'/>

    <int32_t name='metal_ore'/>

    <stl-string name='reaction_class'/>
    <stl-string name='has_material_reaction_product'/>

    <int32_t name='unk4'/>
    <int32_t name='reagent_index'/>

    <stl-vector type-name='int32_t' name='contains' comment='used with custom reactions'/>

    <int32_t name='unk5'/>
    <int16_t name='has_tool_use'/>
  </struct-type>

  <struct-type type-name='activity_entry' key-field='id'>
    <int32_t name='id'/>
    <int16_t name='is_individual'/>
    <stl-vector name='events'>
      <pointer type-name='activity_event'/>
    </stl-vector>
    <int32_t name='unk2'/>
  </struct-type>

  <class-type type-name='activity_event' original-name='activity_eventst'>
    <int32_t name='event_id'
             comment='mostly, but not always, the index in activity.events'/>
    <int32_t name='activity_id' refers-to='(find-activity $)'/>

    -- Guess:
    <int32_t name='subevent_id' comment='-1 unless subevent'/>
    <int32_t name='num_subevents' comment='0 for ind.drill, 2 for all in training session'/>

    <stl-vector name='hist_figure_ids'>
      <int32_t refers-to='(find-by-id $global.world.history.figures $id $)'/>
    </stl-vector>
    <stl-vector name='participant_ids'>
      <int32_t refers-to='(find-unit $)'/>
    </stl-vector>

    -- Either empty, or same as above:
    <stl-vector name='hist_figure_ids2'>
      <int32_t refers-to='(find-by-id $global.world.history.figures $id $)'/>
    </stl-vector>
    <stl-vector name='participant_ids2'>
      <int32_t refers-to='(find-unit $)'/>
    </stl-vector>

    -- These are equal to the ones above:
    <int32_t name='activity_id2' refers-to='(find-activity $)'/>
    <int32_t name='event_id2'/>
  </class-type>

  <class-type type-name='activity_event_individual_skill_drillst' inherits-from='activity_event'>
    <int32_t name='building_id' refers-to='(find-building $)'/>
    <int32_t name='unk5'/>
  </class-type>

  <class-type type-name='activity_event_training_sessionst' inherits-from='activity_event'>
  </class-type>

  <class-type type-name='activity_event_combat_trainingst' inherits-from='activity_event'>
    <int32_t name='building_id' refers-to='(find-building $)'/>
    <int32_t name='hist_figure_id' refers-to='(find-by-id $global.world.history.figures $id $)'/>
    <int32_t name='unit_id' refers-to='(find-unit $)'/>
    <int32_t name='unk5'/>
  </class-type>

  <class-type type-name='activity_event_skill_demonstrationst' inherits-from='activity_event'>
    <int32_t name='building_id' refers-to='(find-building $)'/>
    <int32_t name='hist_figure_id' refers-to='(find-by-id $global.world.history.figures $id $)'/>
    <int32_t name='unit_id' refers-to='(find-unit $)'/>
    <int16_t name='unk5'/>
    <int32_t name='unk6'/>
    <int32_t name='unk7'/>
    <int32_t name='unk8'/>
    <int32_t name='unk9'/>
  </class-type>
</data-definition>
